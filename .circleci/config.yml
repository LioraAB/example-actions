image: ubuntu:20.04
cache:
  paths:
  - variables
test:
  before_script:
  - apt update -qq --fix-missing
  - apt install -y --no-install-recommends nodejs npm make g++
  - npm install @neuralegion/nexploit-cli -g --unsafe-perm || true
  - apt install jq -y
  - apt install curl -y
  script:
  - echo "Start Nexploit Scan :checkered_flag:"
  - >
    SCAN_ID=$(nexploit-cli scan:run --token $NEXPLOIT_TOKEN
    --name "Test Gitlab Scan over my local repeater"
    --test csrf dom_xss xss header_security secret_tokens
    --crawler https://brokencrystals.com
    --smart)
  - echo "export SCAN_ID=$SCAN_ID" > $CI_PROJECT_DIR/variables
  - printf "Scan was started with ID https://nexploit.app/scans/$SCAN_ID\n"
  - printf "Wait for issues :hourglass_flowing_sand:\n"
  - >
    (nexploit-cli scan:polling
    --interval 30s
    --timeout 20m
    --token $NEXPLOIT_TOKEN
    --breakpoint high_issue $SCAN_ID)
  artifacts:
    paths:
    - variables
  allow_failure: true
  after_script:
  - source $CI_PROJECT_DIR/variables
  - >
    if [ -e $CI_PROJECT_DIR/variables ]; then
      echo "Stop Scan :octagonal_sign:"
      nexploit-cli scan:stop --token $NEXPLOIT_TOKEN $SCAN_ID
    else
      echo "Failed to stop scan"
    fi
      GET_ID=$(curl -X 'GET' 'https://app.neuralegion.com/api/v1/scans/'$SCAN_ID'/issues' -H 'accept: application/json' -H    'Authorization:       Api-Key hkvijnw.nexa.2zak6bvklwtmvpfuk9xxeadn003fp4hp' | jq '.[].id' )
      ISSUES_ID_ARRAY=$(sed -e 's/^"//' -e 's/"$//' <<<"$GET_ID")
      a=(); while read -r line; do a+=("$line"); done <<<"$ISSUES_ID_ARRAY"; declare -p a;
      echo "$a"
                GET_NAME=$(curl -X 'GET' 'https://app.neuralegion.com/api/v1/scans/'$SCAN_ID'/issues' -H 'accept: application/json' -H 'Authorization: Api-Key hkvijnw.nexa.2zak6bvklwtmvpfuk9xxeadn003fp4hp' | jq '.[].name' )
                ISSUES_NAME_ARRAY=$(sed -e 's/^"//' -e 's/"$//' <<<"$GET_NAME")
                b=(); while read -r line; do b+=("$line"); done <<<"$ISSUES_NAME_ARRAY"; declare -p b;
                GET_DETAILS=$(curl -X 'GET' 'https://app.neuralegion.com/api/v1/scans/'$SCAN_ID'/issues' -H 'accept: application/json' -H 'Authorization: Api-Key hkvijnw.nexa.2zak6bvklwtmvpfuk9xxeadn003fp4hp' | jq '.[].details' )
                ISSUES_DETAILS_ARRAY=$(sed -e 's/^"//' -e 's/"$//' <<<"$GET_DETAILS")
                c=(); while read -r line; do c+=("$line"); done <<<"$ISSUES_DETAILS_ARRAY"; declare -p c;
                GET_SEVERITY=$(curl -X 'GET' 'https://app.neuralegion.com/api/v1/scans/'$SCAN_ID'/issues' -H 'accept: application/json' -H 'Authorization: Api-Key hkvijnw.nexa.2zak6bvklwtmvpfuk9xxeadn003fp4hp' | jq '.[].severity' )
                ISSUES_SEVERITY_ARRAY=$(sed -e 's/^"//' -e 's/"$//' <<<"$GET_SEVERITY")
                d=(); while read -r line; do d+=("$line"); done <<<"$ISSUES_SEVERITY_ARRAY"; declare -p d;
                GET_PROTOCOL=$(curl -X 'GET' 'https://app.neuralegion.com/api/v1/scans/'$SCAN_ID'/issues' -H 'accept: application/json' -H 'Authorization: Api-Key hkvijnw.nexa.2zak6bvklwtmvpfuk9xxeadn003fp4hp' | jq '.[].protocol' )
                ISSUES_PROTOCOL_ARRAY=$(sed -e 's/^"//' -e 's/"$//' <<<"$GET_PROTOCOL")
                e=(); while read -r line; do e+=("$line"); done <<<"$ISSUES_PROTOCOL_ARRAY"; declare -p e;
                GET_EXPOSURE=$(curl -X 'GET' 'https://app.neuralegion.com/api/v1/scans/'$SCAN_ID'/issues' -H 'accept: application/json' -H 'Authorization: Api-Key hkvijnw.nexa.2zak6bvklwtmvpfuk9xxeadn003fp4hp' | jq '.[].exposure' )
                ISSUES_EXPOSURE_ARRAY=$(sed -e 's/^"//' -e 's/"$//' <<<"$GET_EXPOSURE")
                f=(); while read -r line; do f+=("$line"); done <<<"$ISSUES_EXPOSURE_ARRAY"; declare -p f;
                GET_CVSS=$(curl -X 'GET' 'https://app.neuralegion.com/api/v1/scans/'$SCAN_ID'/issues' -H 'accept: application/json' -H 'Authorization: Api-Key hkvijnw.nexa.2zak6bvklwtmvpfuk9xxeadn003fp4hp' | jq '.[].cvss' )
                ISSUES_CVSS_ARRAY=$(sed -e 's/^"//' -e 's/"$//' <<<"$GET_CVSS")
                g=(); while read -r line; do g+=("$line"); done <<<"$ISSUES_CVSS_ARRAY"; declare -p g;
                GET_CWE=$(curl -X 'GET' 'https://app.neuralegion.com/api/v1/scans/'$SCAN_ID'/issues' -H 'accept: application/json' -H 'Authorization: Api-Key hkvijnw.nexa.2zak6bvklwtmvpfuk9xxeadn003fp4hp' | jq '.[].cwe' )
                ISSUES_CWE_ARRAY=$(sed -e 's/^"//' -e 's/"$//' <<<"$GET_CWE")
                h=(); while read -r line; do h+=("$line"); done <<<"$ISSUES_CWE_ARRAY"; declare -p h;
                GET_TIME=$(curl -X 'GET' 'https://app.neuralegion.com/api/v1/scans/'$SCAN_ID'/issues' -H 'accept: application/json' -H 'Authorization: Api-Key hkvijnw.nexa.2zak6bvklwtmvpfuk9xxeadn003fp4hp' | jq '.[].time' )
                ISSUES_TIME_ARRAY=$(sed -e 's/^"//' -e 's/"$//' <<<"$GET_TIME")
                i=(); while read -r line; do i+=("$line"); done <<<"$ISSUES_TIME_ARRAY"; declare -p i;
      echo "The size of string 'ISSUES_ID_ARRAY' is ${#a[*]}"
      len=${#a[*]}
      i=0
      while [ $i -lt $len ]; do
        echo " "
        echo " "
        echo "ID OF THE SCAN IS    ${a[$i]}"
        echo "NAME    "${b[$i]}
        echo "DETAILS    "${c[$i]}
        echo "SEVERITY    "${d[$i]}
        echo "PROTOCOL    "${e[$i]}
        echo "EXPOSURE    "${f[$i]}
        echo "CVSS    "${g[$i]}
        echo "CWE    "${h[$i]}
        echo "TIME    "${i[$i]}
        let i=i+1
      done
brokencrystals.combrokencrystals.com
Broken Crystals
Broken Crystals

Liora Amina Berisha  2:50 PM
jedem

Nermin Terzo  2:50 PM
aha vazi

Liora Amina Berisha  2:50 PM
ne nego da znas sto kasnim
2:50
da ne bude sutra Liora ne radi
2:50
extra je ovo

Nermin Terzo  2:50 PM
hahahahahaaha

Liora Amina Berisha  2:50 PM
evo pokrecem i sa while

Nermin Terzo  2:50 PM
bjezi tamo
2:51
aj lagano nego ja samo saljem

Liora Amina Berisha  2:51 PM
przim macama piletinu pa da znas ako ne budem tu
2:51
uglavnom, reci cu ja da si ti pravio

Nermin Terzo  2:51 PM
aa vazi vazi
2:51
i nemoj to reci
2:51
naljutit cu se
2:51
zajedno smo napravili

Liora Amina Berisha  2:51 PM
sad mi ne mozes prijetiti da ces napraviti scenu
2:52
:harold:

Nermin Terzo  2:52 PM
hahahah zajedno smo uradili
2:52
zajedno i jesmo uradili
2:52
pa da ti nisi ono trazila
2:52
ja bi zaglavio na onome
2:52
da nisi pokusavala hiljadu nacina ja bi zaglavio
2:52
tako da zajedno smo

Nermin Terzo  3:38 PM
image: ubuntu:20.04
cache:
  paths:
  - variables
test:
  before_script:
  - apt update -qq --fix-missing
  - apt install -y --no-install-recommends nodejs npm make g++
  - npm install @neuralegion/nexploit-cli -g --unsafe-perm || true
  - apt install jq -y
  - apt install curl -y
  script:
  - echo "Start Nexploit Scan :checkered_flag:"
  - >
    SCAN_ID=$(nexploit-cli scan:run --token $NEXPLOIT_TOKEN
    --name "Test Gitlab Scan over my local repeater"
    --test csrf dom_xss xss header_security secret_tokens
    --crawler https://brokencrystals.com
    --smart)
  - echo "export SCAN_ID=$SCAN_ID" > $CI_PROJECT_DIR/variables
  - printf "Scan was started with ID https://nexploit.app/scans/$SCAN_ID\n"
  - printf "Wait for issues :hourglass_flowing_sand:\n"
  - >
    (nexploit-cli scan:polling
    --interval 30s
    --timeout 20m
    --token $NEXPLOIT_TOKEN
    --breakpoint high_issue $SCAN_ID)
  artifacts:
    paths:
    - variables
  allow_failure: true
  after_script:
  - source $CI_PROJECT_DIR/variables
  - >
    if [ -e $CI_PROJECT_DIR/variables ]; then
      echo "Stop Scan :octagonal_sign:"
      nexploit-cli scan:stop --token $NEXPLOIT_TOKEN $SCAN_ID
    else
      echo "Failed to stop scan"
    fi
      GET_ID=$(curl -X 'GET' 'https://app.neuralegion.com/api/v1/scans/'$SCAN_ID'/issues' -H 'accept: application/json' -H    'Authorization:       Api-Key hkvijnw.nexa.2zak6bvklwtmvpfuk9xxeadn003fp4hp' | jq '.[].id' )
      ISSUES_ID_ARRAY=$(sed -e 's/^"//' -e 's/"$//' <<<"$GET_ID")
      a=(); while read -r line; do a+=("$line"); done <<<"$ISSUES_ID_ARRAY"; declare a;
                GET_NAME=$(curl -X 'GET' 'https://app.neuralegion.com/api/v1/scans/'$SCAN_ID'/issues' -H 'accept: application/json' -H 'Authorization: Api-Key hkvijnw.nexa.2zak6bvklwtmvpfuk9xxeadn003fp4hp' | jq '.[].name' )
                ISSUES_NAME_ARRAY=$(sed -e 's/^"//' -e 's/"$//' <<<"$GET_NAME")
                b=(); while read -r line; do b+=("$line"); done <<<"$ISSUES_NAME_ARRAY"; declare b;
                GET_DETAILS=$(curl -X 'GET' 'https://app.neuralegion.com/api/v1/scans/'$SCAN_ID'/issues' -H 'accept: application/json' -H 'Authorization: Api-Key hkvijnw.nexa.2zak6bvklwtmvpfuk9xxeadn003fp4hp' | jq '.[].details' )
                ISSUES_DETAILS_ARRAY=$(sed -e 's/^"//' -e 's/"$//' <<<"$GET_DETAILS")
                c=(); while read -r line; do c+=("$line"); done <<<"$ISSUES_DETAILS_ARRAY"; declare c;
                GET_SEVERITY=$(curl -X 'GET' 'https://app.neuralegion.com/api/v1/scans/'$SCAN_ID'/issues' -H 'accept: application/json' -H 'Authorization: Api-Key hkvijnw.nexa.2zak6bvklwtmvpfuk9xxeadn003fp4hp' | jq '.[].severity' )
                ISSUES_SEVERITY_ARRAY=$(sed -e 's/^"//' -e 's/"$//' <<<"$GET_SEVERITY")
                d=(); while read -r line; do d+=("$line"); done <<<"$ISSUES_SEVERITY_ARRAY"; declare d;
                GET_PROTOCOL=$(curl -X 'GET' 'https://app.neuralegion.com/api/v1/scans/'$SCAN_ID'/issues' -H 'accept: application/json' -H 'Authorization: Api-Key hkvijnw.nexa.2zak6bvklwtmvpfuk9xxeadn003fp4hp' | jq '.[].protocol' )
                ISSUES_PROTOCOL_ARRAY=$(sed -e 's/^"//' -e 's/"$//' <<<"$GET_PROTOCOL")
                e=(); while read -r line; do e+=("$line"); done <<<"$ISSUES_PROTOCOL_ARRAY"; declare e;
                GET_EXPOSURE=$(curl -X 'GET' 'https://app.neuralegion.com/api/v1/scans/'$SCAN_ID'/issues' -H 'accept: application/json' -H 'Authorization: Api-Key hkvijnw.nexa.2zak6bvklwtmvpfuk9xxeadn003fp4hp' | jq '.[].exposure' )
                ISSUES_EXPOSURE_ARRAY=$(sed -e 's/^"//' -e 's/"$//' <<<"$GET_EXPOSURE")
                f=(); while read -r line; do f+=("$line"); done <<<"$ISSUES_EXPOSURE_ARRAY"; declare f;
                GET_CVSS=$(curl -X 'GET' 'https://app.neuralegion.com/api/v1/scans/'$SCAN_ID'/issues' -H 'accept: application/json' -H 'Authorization: Api-Key hkvijnw.nexa.2zak6bvklwtmvpfuk9xxeadn003fp4hp' | jq '.[].cvss' )
                ISSUES_CVSS_ARRAY=$(sed -e 's/^"//' -e 's/"$//' <<<"$GET_CVSS")
                g=(); while read -r line; do g+=("$line"); done <<<"$ISSUES_CVSS_ARRAY"; declare g;
                GET_CWE=$(curl -X 'GET' 'https://app.neuralegion.com/api/v1/scans/'$SCAN_ID'/issues' -H 'accept: application/json' -H 'Authorization: Api-Key hkvijnw.nexa.2zak6bvklwtmvpfuk9xxeadn003fp4hp' | jq '.[].cwe' )
                ISSUES_CWE_ARRAY=$(sed -e 's/^"//' -e 's/"$//' <<<"$GET_CWE")
                h=(); while read -r line; do h+=("$line"); done <<<"$ISSUES_CWE_ARRAY"; declare h;
                GET_TIME=$(curl -X 'GET' 'https://app.neuralegion.com/api/v1/scans/'$SCAN_ID'/issues' -H 'accept: application/json' -H 'Authorization: Api-Key hkvijnw.nexa.2zak6bvklwtmvpfuk9xxeadn003fp4hp' | jq '.[].time' )
                ISSUES_TIME_ARRAY=$(sed -e 's/^"//' -e 's/"$//' <<<"$GET_TIME")
                i=(); while read -r line; do i+=("$line"); done <<<"$ISSUES_TIME_ARRAY"; declare i;
      echo "The size of string 'ISSUES_ID_ARRAY' is ${#a[*]}"
      len=${#a[*]}
      i=0
      while [ $i -lt $len ]; do
        echo " "
        echo " "
        echo "ID OF THE SCAN IS    ${a[$i]}"
        echo "NAME    "${b[$i]}
        echo "DETAILS    "${c[$i]}
        echo "SEVERITY    "${d[$i]}
        echo "PROTOCOL    "${e[$i]}
        echo "EXPOSURE    "${f[$i]}
        echo "CVSS    "${g[$i]}
        echo "CWE    "${h[$i]}
        echo "TIME    "${i[$i]}
        let i=i+1
      done